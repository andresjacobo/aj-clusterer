_.isUndefined(self.aj)&&(aj={}),_.isUndefined(self.aj.geometry)&&(aj.geometry={}),aj.geometry.Point=function(t,i){this.x=t,this.y=i},aj.geometry.Coordinate=function(t,i){this.lat=t,this.lng=i},aj.geometry.Size=function(t,i){this.width=t,this.height=i},aj.geometry.Marker=function(t,i,e,o){this.position=t,this.worldPosition=i,this.clusterCounter=e,this.context=o},aj.geometry.Cluster=function(t){this.markers=t,this.position=t[0].position,this.worldPosition=t[0].worldPosition},aj.geometry.Rect=function(t,i){this.origin=t,this.size=i,this.containsPoint=function(t){return this.origin.x<=t.x&&this.origin.x+this.size.width>=t.x&&this.origin.y<=t.y&&this.origin.y+this.size.height>=t.y?!0:!1},this.containsRect=function(t){return this.origin.x<=t.origin.x&&this.origin.y<=t.origin.y&&this.origin.x+this.size.width>=t.origin.x+t.size.width&&this.origin.y+this.size.height>=t.origin.y+t.size.height?!0:!1},this.intersectsRect=function(t){return this.origin.x<t.origin.x+t.size.width&&this.origin.x+this.size.width>t.origin.x&&this.origin.y<t.origin.y+t.size.height&&this.origin.y+this.size.height>t.origin.y?!0:!1},this.getTopLeftQuadrant=function(){return new aj.geometry.Rect(this.origin,new aj.geometry.Size(this.size.width/2,this.size.height/2))},this.getTopRightQuadrant=function(){return new aj.geometry.Rect(new aj.geometry.Point(this.origin.x+this.size.width/2,this.origin.y),new aj.geometry.Size(this.size.width/2,this.size.height/2))},this.getBottomLeftQuadrant=function(){return new aj.geometry.Rect(new aj.geometry.Point(this.origin.x,this.origin.y+this.size.height/2),new aj.geometry.Size(this.size.width/2,this.size.height/2))},this.getBottomRightQuadrant=function(){return new aj.geometry.Rect(new aj.geometry.Point(this.origin.x+this.size.width/2,this.origin.y+this.size.height/2),new aj.geometry.Size(this.size.width/2,this.size.height/2))}},aj.geometry.TreeNode=function(t){this.topLeft=null,this.topRight=null,this.bottomLeft=null,this.bottomRight=null,this.rect=t,this.contents=[],this.getChildCount=function(){var t=4;return _.isNull(this.topLeft)&&t--,_.isNull(this.topRight)&&t--,_.isNull(this.bottomLeft)&&t--,_.isNull(this.bottomRight)&&t--,t}},aj.geometry.QuadTree=function(t,i){this.treeDepth=t,this.masterNode=i,this.insertItem=function(t,i){this._insertItem(0,this.masterNode,t,i)},this.findItemsInRect=function(t,i){var e=this._recursivelyFindItemsInRect(0,this.masterNode,t);if(e.length<=i||!i)return e;for(var o=[],n=(e.length-1)/(i-1),s=0;i>s;s++)o.push(e[Math.round(n*s)]);return o},this._insertItem=function(t,i,e,o){t==this.treeDepth||(i.rect.getTopLeftQuadrant().containsPoint(o)?(_.isNull(i.topLeft)&&(i.topLeft=new aj.geometry.TreeNode(i.rect.getTopLeftQuadrant())),this._insertItem(t+1,i.topLeft,e,o)):i.rect.getTopRightQuadrant().containsPoint(o)?(_.isNull(i.topRight)&&(i.topRight=new aj.geometry.TreeNode(i.rect.getTopRightQuadrant())),this._insertItem(t+1,i.topRight,e,o)):i.rect.getBottomLeftQuadrant().containsPoint(o)?(_.isNull(i.bottomLeft)&&(i.bottomLeft=new aj.geometry.TreeNode(i.rect.getBottomLeftQuadrant())),this._insertItem(t+1,i.bottomLeft,e,o)):i.rect.getBottomRightQuadrant().containsPoint(o)&&(_.isNull(i.bottomRight)&&(i.bottomRight=new aj.geometry.TreeNode(i.rect.getBottomRightQuadrant())),this._insertItem(t+1,i.bottomRight,e,o))),i.contents.push(e)},this._recursivelyFindItemsInRect=function(t,i,e){if(0==i.getChildCount())return i.contents;var o=[];return!_.isNull(i.topLeft)&&i.topLeft.rect.intersectsRect(e)&&(o=o.concat(this._recursivelyFindItemsInRect(t+1,i.topLeft,e))),!_.isNull(i.topRight)&&i.topRight.rect.intersectsRect(e)&&(o=o.concat(this._recursivelyFindItemsInRect(t+1,i.topRight,e))),!_.isNull(i.bottomLeft)&&i.bottomLeft.rect.intersectsRect(e)&&(o=o.concat(this._recursivelyFindItemsInRect(t+1,i.bottomLeft,e))),!_.isNull(i.bottomRight)&&i.bottomRight.rect.intersectsRect(e)&&(o=o.concat(this._recursivelyFindItemsInRect(t+1,i.bottomRight,e))),o}};